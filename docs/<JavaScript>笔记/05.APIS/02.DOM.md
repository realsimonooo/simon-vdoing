---
title: DOM
date: 2020-09-05 15:43:38
permalink: /pages/516269/
categories:
  - <JavaScript>笔记
---
# `DOM`

(`Document Object Model`)，是W3C组织推荐的处理**可扩展标记语言**（`HTML
或者XML`）的**标准编程接口**。通过这些DOM 接口可以改变网页的内容、结构和样式。



### `DOM 树`

通过这些DOM 接口可以改变网页的**内容、结构和样式**。

+   文档：一个页面就是一个文档，DOM 中使用`document` 表示
+   元素：页面中的所有标签都是元素，DOM 中使用`element` 表示
+   节点：网页中的所有内容都是**节点（标签、属性、文本、注释等）**，`DOM` 中使用`node `表示；
    DOM 把以上内容都看做<mark>对象</mark>

## 获取元素

可以通过以下方式：

+   根据`id`

    ```javascript
    document.getElementById('id'); // 可以获取带有ID 的元素对象
    
    console.dir(); // 打印获取的元素对象，更好的查看对象里面的属性和方法
    ```

+   根据标签名

    ```javascript
    document.getElementsByTagName('标签名');
    // 返回带有指定标签名的对象的集合
    ```

    +   注意 **返回的是一个对象的<mark>集合</mark>**(以伪数组储存)，想要操作当中的元素就需要遍历`tagname[0]等`；
    +   得到的元素对象**是动态的**；内容发生变化则会变化；

+   通过`HTML5`新增的方法

    ```javascript
    // 根据类名返回元素对象集合
    document.getElementsByClassName('类名')；
    ```

    +   `getElement...`返回的是**元素对象**，包括属性和方法；
    +   括号中的参数**大小写敏感**；

    ```javascript
    // 根据指定的选择器返回第一个 【元素对象】
    document.querySelector('选择器');        
    ```

    ```javascript
    // 根据指定的选择器返回所有元素对象集合
    document.querySelectorAll('选择器');
    ```

    `querySelector`和`querySelectorAll`里面的选择器**需要加符号`. #`**,比如:`document.querySelector('#nav');`

+   获取特殊的元素 `<body>` / `<HTML>`

    ```javascript
    // 返回body元素对象
    doucumnet.body
    ```

    ```javascript
    // 获取HTML元素
    document.documentElement
    ```



## `DOM`事件

事件：可以被`JS`侦测到的行为；

+   例： 触发 `...操作`  `点击某个按钮`的响应机制；

网页上的每个元素都可以发生触发`JS`事件；

### 事件三要素

+   事件源 / 什么元素
+   事件类型 / 什么时间
+   事件处理程序 / 触发后的操作

### 执行事件的步骤

1.  获取事件源；
2.  注册事件 / 绑定事件；
3.  添加事件处理程序 （函数的赋值方式）：

#### 常见的鼠标事件 `on...`

<img src="https://gitee.com/realsimonooo/blog-image/raw/master/uPic/7vuZ9G.png" alt="image-20200604173948593" style="zoom:80%;" />

## 操作元素

+   `DOM`的操作元素可以改变网页内容、结构和样式；
+   利用`DOM`可以改变元素的内容、属性；

### 改变元素内容

+   从起始位置到终止位置的内容；（去除`HTML`标签，同时空格和换行也会去掉）

    ```javascript
    element.innerText
    ```

+   起始位置到终止位置的全部内容，(包括`HTML`标签，同时保留空格和换行)；

    +   可以修改包括`HTML`标签在内的内容

    ```javascript
    element.innerHTML
    ```



### 改变元素的步骤

1.  选择元素；
2.  获取元素的属性；（元素是对象）
3.  修改元素的属性；`src / href / id / alt / title`



### 表单元素的操作

`type / value / checked / selected / disabled`

### 改变元素样式操作

```js
element.style
element.className
```

+   修改`style`的操作的原理是 修改的是行内的样式，行内样式的权重比`style`标签内的高。

### 循环排他思想

+   同一组元素，实现某种样式；
    +   首先先设置其他元素为空（确保其他元素不同于目标元素）；
    +   再设定目标元素为目标样式；

### 自定义属性操作

#### 获取属性值

```javascript
element.属性 // 主要获取内置的属性
element.getAttribute('属性');  // 主要获取自定义属性
// id / class
```

#### 设定属性值

```javascript
element.属性 = '指' // 更改内置属性值
element.setAttribute('属性名','值') // 更改自定义属性
```

+   `setAttribute('class','footer')` 

    这里的`class` 指的是`className`

#### 移除属性值

```javascript
element.removeAttribute('属性名');
```

+   自定义属性的目的： 储存数据、调用数据；
+   有些自定义属性不容易判断是否为自定义（不能确定调用的方法）时，使用`HTML5`自定义属性；

#### `HTML5`自定义属性

+   在`HTML5`中，规定自定义属性必须以**`data-`**开头用作属性名，并且赋值；以便于辨识。

    ```HTML
    <div data-index='1'></div>
    ```

+   `HTML5`新增获取自定义属性的方法

    ```javascript
    element.dataset.index
    // 或者
    element.dataset['index']
    ```

    

## 节点操作

### 节点操作目的

+   与`DOM`提供的方法获取元素相比，利用**节点层级关系**获取元素：
    +   利用**父子兄**关系获取元素；
    +   逻辑性强；

### 节点概念

+   节点至少拥有`nodeType (节点类型) / nodeName(节点名称) / nodeValue(节点值)`三个**基本属性**；

    +   `nodeType`的值

        | 元素节点 | 1    |
        | -------- | ---- |
        | 属性节点 | 2    |
        | 文本节点 | 3    |

        +   文本节点包括文字、空格、换行；

    +   一般操作的是**元素节点**；

### 节点层级

+   不同的层级关系，常见的事父子兄弟层级关系：


#### 父节点

```javascript
node.parentNode
```

+   返回某个节点的**==最近的==**父节点;
+   如果没有找到则返回`null`;

#### 子节点

```javascript
parentNode.childNodes
```

+   返回包含指定节点的子节点的**==集合==**，为即时更新的集合；

    +   包含了**所有**的子级点，包括元素节点、文本节点；

        一般不建议使用`childNodes`；
        
        ```js
        // 可以根据节点nodeType筛选处理获取里面的元素节点
        var ul = document.querySelector('ul');
        for(var i = 0; i < ul.childNodes.length; i++){
           if(ul.childNodes[i].nodeType == 1){
        	// ...
           	// 对元素节点的操作
           }
        }
        ```
    
+   推荐使用:

```javascript
parentNode.children 
```

+   是一个**只读**属性，返回所有**子元素**的节点；
    
    + ==只返回子**元素节点**==，其余节点不返回；
    
      

+ 返回**第一个**子节点；

```javascript
parentNode.firstChild // 包含所有的节点
// 或者 parentNode.children[0]
parentNode.firstElementChild // 只返回元素节点
```

+ 返回**最后一个**子节点；

```javascript
parentNode.lastChild // 包含所有的节点
// 或者 parentNode.children[parentNode.children.lenth - 1]
parentNode.lastElementChild // 只返回元素节点
```



#### 兄弟节点

```javascript
node.nextSibling
	// 返回当前元素的下一个兄弟节点，包含所有的节点
	// 找不到则返回null
node.previousSibling
	// 返回当前元素的上一个兄弟节点，包含所有的节点
	// 找不到则返回null
```

```js
node.nextElementSibling
	// 返回当前元素的下一个兄弟节点
node.nextElementSibling
	// 返回当前元素的下一个兄弟节点

// 这两个方法兼容
```

```js
// 解决兼容性
function getNextElemtntSibling(element){
	var el = element;
    while(el = el.nextSibling){
        return el;
    }
    return null;
}
```

### 创建节点

```js
document.createElement('tagName');
// 创建由tagName指定的HTML元素；
```



+ 由于这些元素原本不存在，是根据我们的需求冬天生成的，所以称为**动态创建元素节点**；




### 添加节点

```js
node.appendChile(child)
// 将一个节点添加到指定父节点的子节点列表末尾；
	
// 类似after伪元素(css)
```

```js
node.insertBefore(child, 指定元素)
// 将一个节点添加到父节点指定的子节点前面
// 类似Before为元素(css)
```





```js
// 1.创建元素节点
var li = document.createElement('li');
// 2.添加节点 node父级,child自己
var ul = document.querySelector('ul');
ul.appendChild(li);


// 插入节点
var lichild = document.createElement('li');
ul.insertBefore(lichild, ul.children[0]);
	// ul.children获得父节点的子节点
	// 插入在指定节点的前面
```

### 删除节点

```js
node.removeChild(child)
// 从DOM中删除一个子节点
// 返回删除的节点
```



```js
var ul = document.querySelector('ul');
var btn = document.querySelector('button');

btn.onclick = function(){
    if(ul.children.length == 0){
        this.disabled = true;
    } else{
        ul.removeChild(ul.children[0]);
    }
}
```



### 复制节点

```js
node.cloneNode()
// 返回调用该方法的节点的一个副本
```

+ 如果括号内的参数为空或者`false`，则是浅拷贝，只拷贝节点本身，不拷贝子节点；
+ 如果括号内的参数为`true`，则赋值节点的本身以及所有的子节点；

### 三种动态创建元素的区别

| `document.write()`                                           | `element.innerHTML`                                          | `document.createElement()`             |
| ------------------------------------------------------------ | ------------------------------------------------------------ | -------------------------------------- |
| 将内容写入页面的内容流，但是文档执行完毕会导致页面全部重绘； | 将内容写入某一个DOM节点，不会导致页面全部重绘；              |                                        |
|                                                              | 创建多个元素**效率更高**（不要拼接字符串，采取数组形式拼接）结构稍微复杂； | 创建多个元素效率稍低，但是结构更清晰； |
|                                                              | **兼容性好**；                                                   |                                        |

